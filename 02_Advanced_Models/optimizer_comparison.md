# Optimizer Comparison

このドキュメントでは、GD（勾配降下法）、Momentum（モーメンタム法）、AdaGrad、Adamといった代表的な最適化手法について説明します。各手法の特徴や更新ルールについてまとめています。

## 1. GD（勾配降下法, Gradient Descent）
- **概要**: 勾配降下法は、目的関数の勾配（傾き）を計算し、その方向に沿ってパラメータを調整するシンプルな最適化手法です。最も基本的な手法で、関数の極小値を見つけることを目的としています。
- **更新ルール**: パラメータ \(\theta\) は、目的関数 \(f(\theta)\) の勾配に基づき、学習率 \(\alpha\) に従って更新されます。
  \[
  \theta = \theta - \alpha \nabla f(\theta)
  \]
- **長所**: 実装が簡単で、計算量も少なく済みます。
- **短所**: 局所的な最適解に陥りやすく、また平坦な領域や谷のような形状の関数では収束に時間がかかることがあります。

## 2. Momentum（モーメンタム法）
- **概要**: モーメンタム法は、GDに「慣性」を加えることで、勾配の方向がスムーズになり、最適解により早く到達できるようにした手法です。前のステップの勾配の更新を加速することで、収束速度を向上させます。
- **更新ルール**:
  \[
  v_t = \beta v_{t-1} + \alpha \nabla f(\theta_{t-1})
  \]
  \[
  \theta = \theta - v_t
  \]
  - \(\beta\) はモーメンタム係数で、典型的な値は 0.9 に設定されます。
- **長所**: 平坦な領域や谷状の関数でも高速に収束し、勾配の変動が少なくなります。
- **短所**: 勾配が急激に変わる場合や複雑な最適化問題では、収束が不安定になることがあります。

## 3. AdaGrad
- **概要**: AdaGradは、パラメータごとに異なる学習率を適用する手法です。頻繁に更新されるパラメータの学習率を自動的に減少させ、まれな更新が必要なパラメータに大きな学習率を適用します。
- **更新ルール**:
  \[
  G_t = G_{t-1} + (\nabla f(\theta_{t-1}))^2
  \]
  \[
  \theta = \theta - \frac{\alpha}{\sqrt{G_t + \epsilon}} \nabla f(\theta)
  \]
  - \(\epsilon\) はゼロ割りを避けるための小さな定数です。
- **長所**: スパースなデータ（まれに現れる情報）に対して効果的で、異なるパラメータに応じた学習率調整が行われます。
- **短所**: 学習率が徐々に減少するため、学習が進むにつれて更新が小さくなりすぎ、収束が遅くなることがあります。

## 4. Adam
- **概要**: Adamは、モーメンタム法とAdaGradを組み合わせた手法で、それぞれの長所を取り入れた最適化手法です。勾配の移動平均と、パラメータごとの学習率調整を組み合わせることで、収束の速さと安定性を両立しています。
- **更新ルール**:
  \[
  m_t = \beta_1 m_{t-1} + (1 - \beta_1) \nabla f(\theta_{t-1})
  \]
  \[
  v_t = \beta_2 v_{t-1} + (1 - \beta_2)(\nabla f(\theta_{t-1}))^2
  \]
  \[
  \hat{m_t} = \frac{m_t}{1 - \beta_1^t}, \quad \hat{v_t} = \frac{v_t}{1 - \beta_2^t}
  \]
  \[
  \theta = \theta - \frac{\alpha}{\sqrt{\hat{v_t} + \epsilon}} \hat{m_t}
  \]
  - \(\beta_1\) と \(\beta_2\) はモーメンタム係数（典型的には \(\beta_1=0.9\), \(\beta_2=0.999\)）で、\(\epsilon\) は安定化のための定数です。
- **長所**: 収束が高速で、データ分布が不均一でも安定した学習が可能です。
- **短所**: 非凸関数では、局所的な最適解に陥ることがあります。また、ハイパーパラメータの調整が必要な場合もあります。

---

## まとめ

| 最適化手法 | 長所 | 短所 |
| ---------- | ---- | ---- |
| GD         | シンプルで計算量が少ない | 局所解に陥りやすく、収束が遅い場合あり |
| Momentum   | 収束が速く、変動が少ない | 勾配が急変する場合は不安定になることも |
| AdaGrad    | スパースデータに強く、学習率調整が自動 | 学習率が小さくなりすぎる傾向がある |
| Adam       | 収束が速く安定している | 局所解に陥る場合があり、ハイパーパラメータ調整が必要 |

これらの最適化手法は、目的に応じて使い分けることで、学習速度や収束性を改善することができます。
